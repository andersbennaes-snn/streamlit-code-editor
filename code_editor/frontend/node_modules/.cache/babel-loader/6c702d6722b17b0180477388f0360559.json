{"ast":null,"code":"var _jsxFileName = \"/home/anasbouzid/code-projects/streamlit/custom-components/CodeEditor/code_editor/frontend/src/CodeEditor.tsx\";\nimport { Streamlit, StreamlitComponentBase, withStreamlitConnection } from \"streamlit-component-lib\";\nimport styled from \"styled-components\";\nimport React, { createRef } from \"react\";\nimport * as Icons from \"react-feather\";\nimport AceEditor from \"react-ace\";\nimport { UndoManager } from \"ace-builds\";\nimport \"ace-builds/webpack-resolver\";\nimport \"ace-builds/src-noconflict/mode-python\";\nimport \"ace-builds/src-noconflict/mode-javascript\";\nimport \"ace-builds/src-noconflict/ext-language_tools\";\nimport \"ace-builds/src-noconflict/ext-searchbox\";\nimport \"ace-builds/src-noconflict/ext-prompt\";\nimport \"ace-builds/src-noconflict/ext-modelist\";\nimport \"ace-builds/src-noconflict/ext-keybinding_menu\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst defaultOptions = {\n  maxLines: 20,\n  minLines: 20,\n  fontFamily: '\"Source Code Pro\", monospace',\n  cursorStyle: \"smooth\",\n  displayIndentGuides: false,\n  wrap: true,\n  highlightActiveLine: true,\n  showPrintMargin: false,\n  showLineNumbers: false,\n  foldStyle: \"markbegin\",\n  autoScrollEditorIntoView: true,\n  animatedScroll: true,\n  fadeFoldWidgets: true\n};\nconst defaultEditorProps = {\n  editorProps: {\n    $blockScrolling: true\n  }\n};\nconst defaultProps = {\n  cursorStart: 1,\n  editorProps: defaultEditorProps,\n  enableBasicAutocompletion: false,\n  enableLiveAutocompletion: true,\n  enableSnippets: true,\n  focus: false,\n  fontSize: 16,\n  highlightActiveLine: true,\n  navigateToFileEnd: true,\n  placeholder: null,\n  readOnly: false,\n  scrollMargin: [15, 15, 0, 0],\n  setOptions: defaultOptions,\n  showGutter: true,\n  showPrintMargin: false,\n  style: {},\n  tabSize: 4,\n  width: \"auto\"\n};\n\n/**\n * This is a React-based component template. The `render()` function is called\n * automatically when your component should be re-rendered.\n */\nclass CodeEditor extends StreamlitComponentBase {\n  constructor() {\n    var _this;\n    super(...arguments);\n    _this = this;\n    this.defaultUndoManager = new UndoManager();\n    this.state = {\n      code: this.props.args['code'],\n      lang: this.props.args['lang'],\n      isFocused: false,\n      cursorPosition: {\n        row: 0,\n        column: 1\n      },\n      undoManager: this.defaultUndoManager\n    };\n    this.aceEditor = /*#__PURE__*/createRef();\n    this.ceProps = {};\n    this.codeAceEditor = undefined;\n    this.commands = [{\n      name: 'submit',\n      //name for the key binding.\n      bindKey: {\n        win: 'Ctrl-Enter',\n        mac: 'Command-Enter'\n      },\n      //key combination used for the command.\n      exec: editor => {\n        console.log(\"submit keys pressed\");\n\n        // IMPORTANT: The function `setState()` is required to make sure component state is saved before submit.\n        //            Otherwise changes to the editor and its contents will be lost.\n        this.setState({\n          code: editor.getValue(),\n          cursorPosition: editor.getCursorPosition(),\n          undoManager: editor.getSession().getUndoManager()\n        }, () => {\n          Streamlit.setComponentValue({\n            type: \"submit\",\n            code: editor.getValue()\n          });\n        });\n      }\n    }, {\n      name: 'save-state',\n      bindKey: {\n        win: 'Ctrl-Alt-S',\n        mac: 'Command-Alt-S'\n      },\n      exec: editor => {\n        console.log(\"save state keys pressed\");\n        this.setState({\n          code: editor.getValue(),\n          cursorPosition: editor.getCursorPosition(),\n          undoManager: editor.getSession().getUndoManager(),\n          lang: this.state.lang,\n          isFocused: this.state.isFocused\n        });\n      }\n    }, {\n      name: 'copyAll',\n      exec: editor => {\n        this.unsecureCopyTextToClipboard(editor.getValue());\n      }\n    }, {\n      name: 'reset',\n      exec: () => {\n        this.resetEditor();\n      }\n    }];\n    this.execute = function (command) {\n      var _this$aceEditor$curre;\n      let args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n      const editor = (_this$aceEditor$curre = _this.aceEditor.current) === null || _this$aceEditor$curre === void 0 ? void 0 : _this$aceEditor$curre.editor;\n      if (editor) {\n        if (!args) {\n          editor.execCommand(command);\n        } else if (typeof args === \"number\" || typeof args === \"string\") {\n          editor.execCommand(command, args);\n        } else if (typeof args === \"object\" && !Array.isArray(args)) {\n          var containsNumsStr = true;\n          args.values.array.forEach(element => {\n            containsNumsStr = typeof element === \"string\" || typeof element === \"number\" ? containsNumsStr : false;\n          });\n          if (args.values.length < 4 && containsNumsStr) {\n            editor.execCommand(command, args);\n          }\n        } else {\n          console.warn(`failed to execute \"${command}\" command!`);\n        }\n      }\n    };\n    this.executeAll = function (commands) {\n      let sendResponse = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n      commands.forEach(command => {\n        if (Array.isArray(command)) {\n          typeof command[0] === \"string\" ? _this.execute(command[0], command[1]) : console.warn(\"improper command format!\");\n        } else if (typeof command === \"string\") {\n          _this.execute(command);\n        } else {\n          console.warn(\"failed to execute command!\");\n        }\n      });\n      if (sendResponse) {\n        _this.respond(sendResponse);\n      }\n    };\n    this.respond = function () {\n      let responseType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"submit\";\n      console.log(\"respond called:\" + responseType);\n      _this.setState(_this.state, () => {\n        Streamlit.setComponentValue({\n          type: responseType,\n          code: _this.state.code\n        });\n      });\n    };\n    this.resetEditor = function () {\n      let keepUndo = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      const newUndoManager = keepUndo ? _this.aceEditor.current ? _this.aceEditor.current.editor.getSession().getUndoManager() : _this.state.undoManager : _this.defaultUndoManager;\n      _this.setState({\n        code: _this.props.args['code'],\n        lang: _this.props.args['lang'],\n        isFocused: false,\n        cursorPosition: {\n          row: 0,\n          column: 1\n        },\n        undoManager: newUndoManager\n      });\n    };\n    this.copyToClipboard = async () => {\n      try {\n        await navigator.clipboard.writeText(this.state.code);\n        console.log(this.state.code);\n      } catch (err) {\n        console.warn('Failed to copy securely -> reverting to unsecure copy');\n        this.unsecureCopyToClipboard();\n      }\n    };\n    this.unsecureCopyToClipboard = () => {\n      const textField = document.createElement('textarea');\n      textField.value = this.aceEditor.current ? this.aceEditor.current.editor.getValue() : this.state.code;\n      document.body.appendChild(textField);\n      textField.select();\n      document.execCommand('copy');\n      textField.remove();\n    };\n    this.unsecureCopyTextToClipboard = text => {\n      const textField = document.createElement('textarea');\n      textField.value = text;\n      document.body.appendChild(textField);\n      textField.select();\n      document.execCommand('copy');\n      textField.remove();\n    };\n    this.createSnippets = snippets => {\n      return typeof snippets === \"string\" ? snippets : (Array.isArray(snippets) ? snippets : [snippets]).map(_ref => {\n        let {\n          name,\n          code\n        } = _ref;\n        return ['snippet ' + name, code.split('\\n').map(c => '\\t' + c).join('\\n')].join('\\n');\n      }).join('\\n');\n    };\n    this.handleOnFocus = (event, editor) => {\n      console.log(\"~~onFocus~~\");\n      console.log(\"~~~~~~~~~~~~~\");\n    };\n    this.handleOnBlur = (event, editor) => {\n      console.log(\"~~onBlur~~\");\n      console.log(\"~~~~~~~~~~~~~\");\n      // if(event.relatedTarget || event.sourceCapabilities){\n      //   this.state = {code: editor?.getValue() || this.state.code, cursorPosition: editor?.getCursorPosition() || this.state.cursorPosition, undoManager: editor?.getSession().getUndoManager() || this.state.undoManager, lang: this.state.lang, isFocused: this.state.isFocused}\n      // } else {\n      //   this.setState({code: editor?.getValue() || this.state.code, cursorPosition: editor?.getCursorPosition() || this.state.cursorPosition, undoManager: editor?.getSession().getUndoManager() || this.state.undoManager, lang: this.state.lang, isFocused: this.state.isFocused});\n      // }\n    };\n    this.handleBeforeLoad = Ace => {\n      console.log(\"~before load~\");\n      console.log(\"~~~~~~~~~~~~~\");\n    };\n    this.handleOnLoad = editor => {\n      console.log(\"~on load~\");\n      console.log(\"~~~~~~~~~~~~~\");\n\n      // ace.require(\"ace/ext/keybinding_menu\").init(editor);\n\n      // const snippets = this.createSnippets(this.props.args['snippets']);\n      // if(snippets){\n      //   const snippetManager = ace.require('ace/snippets').snippetManager;\n\n      //   snippetManager.register(snippetManager.parseSnippetFile(snippets, this.state.lang), this.state.lang)\n      //   console.log(JSON.stringify(snippets))\n      // }\n\n      // editor.getSession().setUndoManager(this.state.undoManager);\n\n      // const cursorPos = this.state.cursorPosition;\n      // console.log(cursorPos);\n      // editor.moveCursorTo(cursorPos.row, cursorPos.column);\n      // editor.renderer.scrollCursorIntoView(cursorPos, 0.5);\n      //editor.resize();\n    };\n    this.render = () => {\n      console.log(this.aceEditor.current);\n      const codeEditorProps = this.props.args[\"rootProps\"];\n      const aceEditorProps = {\n        ...defaultEditorProps,\n        ...this.props.args['editorProps']\n      };\n      const aceOptions = {\n        ...defaultOptions,\n        ...this.props.args['options']\n      };\n      const partProps = {\n        setOptions: aceOptions,\n        editorProps: aceEditorProps\n      };\n      const aceProps = {\n        ...defaultProps,\n        ...partProps,\n        ...this.props.args['props']\n      };\n      const customButtons = this.props.args['buttons'];\n      const menudict = this.props.args['menu'];\n      const infoBarDict = this.props.args['info'];\n      console.log(\"Render----------------\");\n      console.log(this.state.lang);\n      const {\n        theme\n      } = this.props;\n      const style = {};\n      const editorTheme = this.props.args[\"theme\"];\n      const defaultTheme = theme ? theme.base : \"dark\";\n      var themeProp = \"streamlit_dark\";\n      switch (editorTheme) {\n        case \"contrast\":\n          themeProp = defaultTheme === \"dark\" ? \"streamlit_light\" : \"streamlit_dark\";\n          break;\n        case \"light\":\n          themeProp = \"streamlit_light\";\n          break;\n        case \"dark\":\n          themeProp = \"streamlit_dark\";\n          break;\n        case \"default\":\n          themeProp = defaultTheme === \"dark\" ? \"streamlit_dark\" : \"streamlit_light\";\n          break;\n        default:\n          themeProp = defaultTheme === \"dark\" ? \"streamlit_dark\" : \"streamlit_light\";\n          break;\n      }\n      const chosen_theme = themeProp === \"streamlit_dark\" ? require(\"ace-builds/src-noconflict/theme-streamlit_dark\") : require(\"ace-builds/src-noconflict/theme-streamlit_light\");\n      const StyledCodeEditor = styled.div`\n      border-radius: 8px;\n      overflow: hidden;\n      display: flex;\n      flex-direction: column;\n      :hover button {\n        opacity: 1;\n        transform: scale(1);\n      }\n      button.always-on {\n        opacity: 1;\n        transform: scale(1);\n        transition: none;\n      }\n      :hover button svg {\n            opacity: 1;\n            transform: scale(1);\n      }\n      :hover button.with-icon span {\n        opacity: 1;\n        transform: scale(1);\n      }\n      button.always-on > span {\n        opacity: 1;\n        transform: scale(1);\n        transition: none;\n      }\n      button.always-on > svg {\n        opacity: 1;\n        transform: scale(1);\n        transition: none;\n      }\n    `;\n      const StyledDiv = styled.div``;\n      const StyledRegSpan = styled.span``;\n      const StyledSpan = styled.span`\n      height: 2.5rem;\n      line-height: 2.5rem;\n      margin: 0px 0.4rem 0.15rem 0.4rem;\n      opacity: 0;\n      transform: scale(0);\n      transition: opacity 300ms 150ms, transform 300ms 150ms;\n    `;\n      const StyledButton = styled.button`\n      border: none;\n      border-radius: 5px;\n      background: none;\n      height: 2.5rem;\n      line-height: 0;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      opacity: 0;\n      position: absolute;\n      transform: scale(0);\n      transition: opacity 20ms 300ms, transform 20ms 300ms;\n      top: ${props => props.theme.top || \"\"};\n      left: ${props => props.theme.left || \"\"};\n      right: ${props => props.theme.right || \"\"};\n      bottom: ${props => props.theme.bottom || \"\"};\n      z-index: 101;\n      :focus {\n        outline: none;\n      }\n      span{\n        color: ${themeProp === \"streamlit_dark\" ? \"rgba(250,250,250,0.6)\" : \"rgba(0,0,0,0.5)\"};\n        transform: scale(0);\n        transform-origin: right;\n        transition: opacity 300ms 150ms, transform 300ms 150ms;\n      }\n      :hover span {\n        color: ${props => props.primary ? theme ? theme.primaryColor : \"rgba(250,250,250,1)\" : themeProp === \"streamlit_dark\" ? \"rgb(250,250,250)\" : \"rgb(49, 51, 63)\"};\n        opacity: 1;\n        transform: scale(1);\n      }\n      svg {\n        stroke: ${themeProp === \"streamlit_dark\" ? \"rgba(250,250,250,0.6)\" : \"rgba(0,0,0,0.5)\"};\n        transform: scale(0);\n        transition: opacity 300ms 150ms, transform 300ms 150ms;\n      }\n      :hover svg {\n        stroke: ${props => props.primary ? theme ? theme.primaryColor : \"rgba(250,250,250,1)\" : themeProp === \"streamlit_dark\" ? \"rgb(250,250,250)\" : \"rgb(49, 51, 63)\"};\n      }\n    `;\n      const creatIcon = function (name) {\n        let size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n        const CustomIcon = Icons[name];\n        return /*#__PURE__*/_jsxDEV(CustomIcon, {\n          size: `${size}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 14\n        }, _this);\n      };\n      return /*#__PURE__*/_jsxDEV(StyledCodeEditor, {\n        style: codeEditorProps,\n        className: \"streamlit_code-editor\",\n        children: [/*#__PURE__*/_jsxDEV(AceEditor, {\n          ref: this.aceEditor,\n          name: \"REACT_ACE_EDITOR\",\n          mode: this.state.lang,\n          theme: themeProp,\n          keyboardHandler: this.props.args[\"shortcuts\"],\n          value: this.state.code,\n          onBeforeLoad: this.handleBeforeLoad,\n          onLoad: this.handleOnLoad,\n          onFocus: this.handleOnFocus,\n          onBlur: this.handleOnBlur,\n          commands: this.commands,\n          ...aceProps\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 9\n        }, this), customButtons ? customButtons.map((button, index) => /*#__PURE__*/_jsxDEV(StyledButton, {\n          primary: button.primary || false,\n          className: (button.class ? button.class : \"\") + (button.alwaysOn ? \" always-on\" : \"\") + (button.showWithIcon ? \" with-icon\" : \"\"),\n          theme: button.theme ? button.theme : {},\n          style: button.style ? button.style : {},\n          onClick: button.commands || button.response ? () => this.executeAll(button.commands || [], button.response) : () => {},\n          children: [button.hasText && button.name ? /*#__PURE__*/_jsxDEV(StyledSpan, {\n            children: button.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 49\n          }, this) : ``, button.feather ? creatIcon(button.feather || \"Copy\", button.iconSize) : \"\"]\n        }, button.name + index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 11\n        }, this)) : ``, menudict ? Object.keys(menudict).length === 0 ? `` : /*#__PURE__*/_jsxDEV(StyledDiv, {\n          className: \"custom_menu\",\n          style: menudict.menuProps || {},\n          children: !menudict.groups ? `` : menudict.groups.map((group, index) => /*#__PURE__*/_jsxDEV(StyledDiv, {\n            className: \"menu_group \" + group.name,\n            style: group.style || {},\n            children: group.buttons.map((button, index) => /*#__PURE__*/_jsxDEV(StyledButton, {\n              primary: button.primary || false,\n              className: (button.class ? button.class : \"\") + (button.alwaysOn ? \" always-on\" : \"\") + (button.showWithIcon ? \" with-icon\" : \"\"),\n              theme: button.theme || {},\n              style: button.style || {},\n              onClick: button.commands || button.response ? () => this.executeAll(button.commands || [], button.response) : () => {},\n              children: [button.hasText && button.name ? /*#__PURE__*/_jsxDEV(StyledSpan, {\n                children: button.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 468,\n                columnNumber: 55\n              }, this) : ``, button.feather ? creatIcon(button.feather || \"Copy\", button.iconSize) : \"\"]\n            }, button.name ? group.name + \"_\" + button.name + index : group.name + \"_button\" + index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 17\n            }, this))\n          }, \"group_\" + group.name + index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 13\n          }, this))\n        }, \"menu_bar\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 62\n        }, this) : ``, infoBarDict ? Object.keys(infoBarDict).length === 0 ? `` : /*#__PURE__*/_jsxDEV(StyledDiv, {\n          className: \"custom_info_bar \" + (infoBarDict.name ? infoBarDict.name : \"\"),\n          style: infoBarDict.style,\n          children: (infoBarDict.info || []).map((info, index) => /*#__PURE__*/_jsxDEV(StyledRegSpan, {\n            className: info.class || ``,\n            style: info.style || {},\n            children: info.name\n          }, \"info_\" + (info.name ? info.name : \"\") + index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 478,\n            columnNumber: 13\n          }, this))\n        }, \"info_bar\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 68\n        }, this) : ``]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 7\n      }, this);\n    };\n  } //END OF RENDER FUNCTION\n  //----------------------------------------------------------------------\n}\nexport default _c = withStreamlitConnection(CodeEditor);\nvar _c;\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"names":["Streamlit","StreamlitComponentBase","withStreamlitConnection","styled","React","createRef","Icons","AceEditor","UndoManager","defaultOptions","maxLines","minLines","fontFamily","cursorStyle","displayIndentGuides","wrap","highlightActiveLine","showPrintMargin","showLineNumbers","foldStyle","autoScrollEditorIntoView","animatedScroll","fadeFoldWidgets","defaultEditorProps","editorProps","$blockScrolling","defaultProps","cursorStart","enableBasicAutocompletion","enableLiveAutocompletion","enableSnippets","focus","fontSize","navigateToFileEnd","placeholder","readOnly","scrollMargin","setOptions","showGutter","style","tabSize","width","CodeEditor","defaultUndoManager","state","code","props","args","lang","isFocused","cursorPosition","row","column","undoManager","aceEditor","ceProps","codeAceEditor","undefined","commands","name","bindKey","win","mac","exec","editor","console","log","setState","getValue","getCursorPosition","getSession","getUndoManager","setComponentValue","type","unsecureCopyTextToClipboard","resetEditor","execute","command","current","execCommand","Array","isArray","containsNumsStr","values","array","forEach","element","length","warn","executeAll","sendResponse","respond","responseType","keepUndo","newUndoManager","copyToClipboard","navigator","clipboard","writeText","err","unsecureCopyToClipboard","textField","document","createElement","value","body","appendChild","select","remove","text","createSnippets","snippets","map","split","c","join","handleOnFocus","event","handleOnBlur","handleBeforeLoad","Ace","handleOnLoad","render","codeEditorProps","aceEditorProps","aceOptions","partProps","aceProps","customButtons","menudict","infoBarDict","theme","editorTheme","defaultTheme","base","themeProp","chosen_theme","require","StyledCodeEditor","div","StyledDiv","StyledRegSpan","span","StyledSpan","StyledButton","button","top","left","right","bottom","primary","primaryColor","creatIcon","size","CustomIcon","index","class","alwaysOn","showWithIcon","response","hasText","feather","iconSize","Object","keys","menuProps","groups","group","buttons","info"],"sources":["/home/anasbouzid/code-projects/streamlit/custom-components/CodeEditor/code_editor/frontend/src/CodeEditor.tsx"],"sourcesContent":["import {\n  Streamlit,\n  StreamlitComponentBase,\n  withStreamlitConnection,\n} from \"streamlit-component-lib\"\nimport styled from \"styled-components\"\nimport React, { ReactNode, createRef } from \"react\"\nimport * as Icons from \"react-feather\"\nimport AceEditor, { IAceEditorProps } from \"react-ace\";\nimport ace, { UndoManager } from \"ace-builds\";\n\nimport \"ace-builds/webpack-resolver\";\nimport \"ace-builds/src-noconflict/mode-python\";\nimport \"ace-builds/src-noconflict/mode-javascript\";\nimport \"ace-builds/src-noconflict/ext-language_tools\";\nimport \"ace-builds/src-noconflict/ext-searchbox\";\nimport \"ace-builds/src-noconflict/ext-prompt\";\nimport \"ace-builds/src-noconflict/ext-modelist\";\nimport { IAceEditor } from \"react-ace/lib/types\";\nimport \"ace-builds/src-noconflict/ext-keybinding_menu\";\nimport ReactAce from \"react-ace/lib/ace\";\n\ninterface State {\n  code: string\n  lang: string\n  isFocused: boolean\n  undoManager: object\n  cursorPosition: object\n}\n\ninterface customInfoText {\n  name: string,\n  class?: string,\n  style?: object,\n  theme?: object\n}\n\ninterface infoBar {\n  name?: string,\n  style?: object,\n  info?: customInfoText[]\n}\n\ninterface customButton {\n  name: string,\n  feather?: string,\n  iconSize?: number,\n  primary?: boolean,\n  hasText?: boolean,\n  showWithIcon?: boolean,\n  alwaysOn?: boolean,\n  commands?: any[],\n  response?: string,\n  class?: string,\n  style?: object,\n  theme?: object\n}\n\ninterface buttonGroup {\n  name: string,\n  style?: object,\n  buttons: customButton[]\n}\n\ninterface menu {\n  menuProps?: object,\n  groups?: buttonGroup[]\n}\n\nconst defaultOptions = {\n  maxLines: 20,\n  minLines: 20,\n  fontFamily: '\"Source Code Pro\", monospace',\n  cursorStyle: \"smooth\",\n  displayIndentGuides: false,\n  wrap: true,\n  highlightActiveLine: true,\n  showPrintMargin: false,\n  showLineNumbers: false,\n  foldStyle: \"markbegin\",\n  autoScrollEditorIntoView: true,\n  animatedScroll: true,\n  fadeFoldWidgets: true,\n}\n\nconst defaultEditorProps = {\n  editorProps: {\n    $blockScrolling: true\n  }\n}\n\nconst defaultProps = {\n  cursorStart: 1,\n  editorProps: defaultEditorProps,\n  enableBasicAutocompletion: false,\n  enableLiveAutocompletion: true,\n  enableSnippets: true,\n  focus: false,\n  fontSize: 16,\n  highlightActiveLine: true,\n  navigateToFileEnd: true,\n  placeholder: null,\n  readOnly: false,\n  scrollMargin: [15,15,0,0],\n  setOptions: defaultOptions,\n  showGutter: true,\n  showPrintMargin: false,\n  style: {},\n  tabSize: 4,\n  width:\"auto\",\n}\n\n/**\n * This is a React-based component template. The `render()` function is called\n * automatically when your component should be re-rendered.\n */\nclass CodeEditor extends StreamlitComponentBase<State> {\n  private defaultUndoManager = new UndoManager();\n  public state = {code: this.props.args['code'], lang: this.props.args['lang'], isFocused: false, cursorPosition: {row: 0, column: 1}, undoManager: this.defaultUndoManager}\n\n  private aceEditor = createRef<AceEditor>();\n  private ceProps = {} as IAceEditorProps;\n  private codeAceEditor: undefined | ReactNode = undefined;\n\n  // commands is array of key bindings.\n  private commands = [{   \n                      name: 'submit', //name for the key binding.\n                      bindKey: {win: 'Ctrl-Enter', mac: 'Command-Enter'}, //key combination used for the command.\n                      exec: (editor: ace.Ace.Editor) => {\n                         console.log(\"submit keys pressed\")\n                      \n                         // IMPORTANT: The function `setState()` is required to make sure component state is saved before submit.\n                         //            Otherwise changes to the editor and its contents will be lost.\n                         this.setState({code: editor.getValue(), cursorPosition: editor.getCursorPosition(), undoManager: editor.getSession().getUndoManager()}, () => {Streamlit.setComponentValue({ type: \"submit\", code: editor.getValue()});}); \n                        }\n                      },{\n                      name: 'save-state',\n                      bindKey: {win: 'Ctrl-Alt-S', mac: 'Command-Alt-S'},\n                      exec: (editor: ace.Ace.Editor) => {\n                         console.log(\"save state keys pressed\")\n                         \n                         this.setState({code: editor.getValue(), cursorPosition: editor.getCursorPosition(), undoManager: editor.getSession().getUndoManager(), lang: this.state.lang, isFocused: this.state.isFocused});\n                        }\n                      },{\n                        name: 'copyAll',\n                        exec: (editor: ace.Ace.Editor) => {\n                            this.unsecureCopyTextToClipboard(editor.getValue());  \n                          }\n                        },{\n                          name: 'reset',\n                          exec: () => {\n                              this.resetEditor();  \n                            }\n                          }];\n\n  private execute = (command: string, args: any = \"\") => {\n    const editor = this.aceEditor.current?.editor;\n    if (editor){\n      if (!args){\n        editor.execCommand(command)\n      }\n      else if (typeof args === \"number\" || typeof args === \"string\"){\n        editor.execCommand(command, args);\n      }\n      else if (typeof args === \"object\" && !Array.isArray(args)){\n        var containsNumsStr = true;\n        args.values.array.forEach((element: any) => {\n            containsNumsStr = (typeof element === \"string\" || typeof element === \"number\")? containsNumsStr : false;\n        });\n        if (args.values.length < 4 && containsNumsStr){\n          editor.execCommand(command, args);\n        }\n      }\n      else {\n        console.warn(`failed to execute \"${command}\" command!`);\n      }\n    }\n  }\n\n  private executeAll = (commands: any[], sendResponse = \"\") => {\n    commands.forEach(command => {\n      if (Array.isArray(command)){\n        typeof command[0] === \"string\"? this.execute(command[0], command[1]) : console.warn(\"improper command format!\");\n      } else if (typeof command === \"string\"){\n        this.execute(command);\n      } else {\n        console.warn(\"failed to execute command!\");\n      }\n    });\n\n    if(sendResponse){\n      this.respond(sendResponse);\n    }\n  }\n\n  public respond = (responseType = \"submit\") => {\n    console.log(\"respond called:\" + responseType);\n    this.setState(this.state, () => {Streamlit.setComponentValue({ type: responseType, code: this.state.code});});\n  }\n\n  public resetEditor = (keepUndo = true) => {\n    const newUndoManager = keepUndo? (this.aceEditor.current? this.aceEditor.current.editor.getSession().getUndoManager() : this.state.undoManager ) : this.defaultUndoManager;\n    this.setState({code: this.props.args['code'], lang: this.props.args['lang'], isFocused: false, cursorPosition: {row: 0, column: 1}, undoManager: newUndoManager});\n  }\n\n  public copyToClipboard = async (): Promise<void> => {\n    try {\n      await navigator.clipboard.writeText(this.state.code);\n      console.log(this.state.code);\n    } catch (err) {\n      console.warn('Failed to copy securely -> reverting to unsecure copy');\n      this.unsecureCopyToClipboard();\n    }\n  }\n\n  private unsecureCopyToClipboard = () => {\n    const textField = document.createElement('textarea');\n    textField.value = this.aceEditor.current? this.aceEditor.current.editor.getValue() : this.state.code;\n    document.body.appendChild(textField);\n    textField.select();\n    document.execCommand('copy');\n    textField.remove();\n  }\n\n  private unsecureCopyTextToClipboard = (text: string) => {\n    const textField = document.createElement('textarea');\n    textField.value = text;\n    document.body.appendChild(textField);\n    textField.select();\n    document.execCommand('copy');\n    textField.remove();\n  }\n\n  private createSnippets = (snippets: string | object | [object]) : string => {\n    return( typeof snippets === \"string\" ? snippets : (Array.isArray(snippets) ? snippets : [snippets]).map(({ name, code }) =>\n        ([\n            'snippet ' + name,\n            code.split('\\n')\n                .map((c: string) => '\\t' + c)\n                .join('\\n'),\n        ].join('\\n'))\n    ).join('\\n'))\n  }\n  private handleOnFocus = (event: any, editor: IAceEditor) => {\n    console.log(\"~~onFocus~~\");\n    console.log(\"~~~~~~~~~~~~~\");\n  }\n\n  private handleOnBlur = (event: any, editor: IAceEditor) => {\n    console.log(\"~~onBlur~~\");\n    console.log(\"~~~~~~~~~~~~~\");\n    // if(event.relatedTarget || event.sourceCapabilities){\n    //   this.state = {code: editor?.getValue() || this.state.code, cursorPosition: editor?.getCursorPosition() || this.state.cursorPosition, undoManager: editor?.getSession().getUndoManager() || this.state.undoManager, lang: this.state.lang, isFocused: this.state.isFocused}\n    // } else {\n    //   this.setState({code: editor?.getValue() || this.state.code, cursorPosition: editor?.getCursorPosition() || this.state.cursorPosition, undoManager: editor?.getSession().getUndoManager() || this.state.undoManager, lang: this.state.lang, isFocused: this.state.isFocused});\n    // }\n  }\n\n  private handleBeforeLoad = (Ace: typeof ace) => {\n    console.log(\"~before load~\");\n    console.log(\"~~~~~~~~~~~~~\");\n  }\n\n  private handleOnLoad = (editor: ace.Ace.Editor) => {\n    console.log(\"~on load~\");\n    console.log(\"~~~~~~~~~~~~~\")\n\n    // ace.require(\"ace/ext/keybinding_menu\").init(editor);\n    \n    // const snippets = this.createSnippets(this.props.args['snippets']);\n    // if(snippets){\n    //   const snippetManager = ace.require('ace/snippets').snippetManager;\n\n    //   snippetManager.register(snippetManager.parseSnippetFile(snippets, this.state.lang), this.state.lang)\n    //   console.log(JSON.stringify(snippets))\n    // }\n\n    // editor.getSession().setUndoManager(this.state.undoManager);\n\n    // const cursorPos = this.state.cursorPosition;\n    // console.log(cursorPos);\n    // editor.moveCursorTo(cursorPos.row, cursorPos.column);\n    // editor.renderer.scrollCursorIntoView(cursorPos, 0.5);\n    //editor.resize();\n  }\n\n  //-------------------------------------------------------------------------\n  // RENDER FUNCTION\n  public render = (): ReactNode => {\n\n    console.log(this.aceEditor.current);\n\n    const codeEditorProps = this.props.args[\"rootProps\"]\n    const aceEditorProps = {...defaultEditorProps, ...this.props.args['editorProps']};\n    const aceOptions = {...defaultOptions, ...this.props.args['options']}\n    const partProps = {setOptions: aceOptions, editorProps: aceEditorProps}\n    const aceProps = {...defaultProps, ...partProps, ...this.props.args['props']}\n\n    const customButtons = this.props.args['buttons'] as customButton[];\n    const menudict = this.props.args['menu'] as menu;\n    const infoBarDict = this.props.args['info'] as infoBar;\n\n    console.log(\"Render----------------\");\n\n    console.log(this.state.lang)\n\n    const { theme } = this.props\n    const style: React.CSSProperties = {}\n    \n    const editorTheme = this.props.args[\"theme\"];\n    const defaultTheme = theme? theme.base : \"dark\";\n    var themeProp = \"streamlit_dark\";\n    switch (editorTheme) {\n      case \"contrast\":\n        themeProp = (defaultTheme === \"dark\")? \"streamlit_light\" : \"streamlit_dark\";\n        break;\n      case \"light\":\n        themeProp = \"streamlit_light\";\n        break;\n      case \"dark\":\n        themeProp = \"streamlit_dark\";\n        break;\n      case \"default\":\n        themeProp = (defaultTheme === \"dark\")? \"streamlit_dark\" : \"streamlit_light\";\n        break;\n      default:\n        themeProp = (defaultTheme === \"dark\")? \"streamlit_dark\" : \"streamlit_light\";\n        break;\n    }\n\n    const chosen_theme = (themeProp === \"streamlit_dark\")? require(\"ace-builds/src-noconflict/theme-streamlit_dark\") : require(\"ace-builds/src-noconflict/theme-streamlit_light\");\n\n    const StyledCodeEditor = styled.div`\n      border-radius: 8px;\n      overflow: hidden;\n      display: flex;\n      flex-direction: column;\n      :hover button {\n        opacity: 1;\n        transform: scale(1);\n      }\n      button.always-on {\n        opacity: 1;\n        transform: scale(1);\n        transition: none;\n      }\n      :hover button svg {\n            opacity: 1;\n            transform: scale(1);\n      }\n      :hover button.with-icon span {\n        opacity: 1;\n        transform: scale(1);\n      }\n      button.always-on > span {\n        opacity: 1;\n        transform: scale(1);\n        transition: none;\n      }\n      button.always-on > svg {\n        opacity: 1;\n        transform: scale(1);\n        transition: none;\n      }\n    `;\n\n    const StyledDiv = styled.div``;\n    const StyledRegSpan = styled.span``;\n\n    const StyledSpan = styled.span`\n      height: 2.5rem;\n      line-height: 2.5rem;\n      margin: 0px 0.4rem 0.15rem 0.4rem;\n      opacity: 0;\n      transform: scale(0);\n      transition: opacity 300ms 150ms, transform 300ms 150ms;\n    `;\n    \n    const StyledButton = styled.button<{primary: boolean}>`\n      border: none;\n      border-radius: 5px;\n      background: none;\n      height: 2.5rem;\n      line-height: 0;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      opacity: 0;\n      position: absolute;\n      transform: scale(0);\n      transition: opacity 20ms 300ms, transform 20ms 300ms;\n      top: ${props => props.theme.top || \"\"};\n      left: ${props => props.theme.left || \"\"};\n      right: ${props => props.theme.right || \"\"};\n      bottom: ${props => props.theme.bottom || \"\"};\n      z-index: 101;\n      :focus {\n        outline: none;\n      }\n      span{\n        color: ${themeProp === \"streamlit_dark\"? \"rgba(250,250,250,0.6)\": \"rgba(0,0,0,0.5)\"};\n        transform: scale(0);\n        transform-origin: right;\n        transition: opacity 300ms 150ms, transform 300ms 150ms;\n      }\n      :hover span {\n        color: ${props => props.primary? theme? theme.primaryColor : \"rgba(250,250,250,1)\" : themeProp === \"streamlit_dark\"? \"rgb(250,250,250)\" : \"rgb(49, 51, 63)\"};\n        opacity: 1;\n        transform: scale(1);\n      }\n      svg {\n        stroke: ${themeProp === \"streamlit_dark\"? \"rgba(250,250,250,0.6)\": \"rgba(0,0,0,0.5)\"};\n        transform: scale(0);\n        transition: opacity 300ms 150ms, transform 300ms 150ms;\n      }\n      :hover svg {\n        stroke: ${props => props.primary? theme? theme.primaryColor : \"rgba(250,250,250,1)\" : themeProp === \"streamlit_dark\"? \"rgb(250,250,250)\": \"rgb(49, 51, 63)\"};\n      }\n    `;\n\n    type iconKey = keyof typeof Icons;\n    const creatIcon = (name: iconKey, size = 16) => {\n      const CustomIcon = Icons[name];\n      return <CustomIcon size={`${size}`} />;\n    }\n\n    return (\n      <StyledCodeEditor style={codeEditorProps} className=\"streamlit_code-editor\">\n        {/* {this.codeAceEditor ?? (this.codeAceEditor = ( */}\n        <AceEditor\n          ref={this.aceEditor}\n          name=\"REACT_ACE_EDITOR\"\n          mode={this.state.lang}\n          theme={themeProp}\n          keyboardHandler={this.props.args[\"shortcuts\"]}\n          value={this.state.code}\n          onBeforeLoad={this.handleBeforeLoad}\n          onLoad={this.handleOnLoad}\n          onFocus={this.handleOnFocus}\n          onBlur={this.handleOnBlur}\n          commands={this.commands}\n          {...aceProps}\n        />\n        {/* ))} */}\n        {customButtons?customButtons.map( (button, index) => (\n          <StyledButton \n            primary={button.primary || false}\n            key={button.name + index} \n            className={(button.class? button.class: \"\" ) + (button.alwaysOn? \" always-on\" : \"\") + (button.showWithIcon? \" with-icon\" : \"\")}\n            theme={button.theme? button.theme : {}}\n            style={button.style? button.style : {}} \n            onClick={(button.commands || button.response)? () => this.executeAll(button.commands || [], button.response) : () => {}}>\n              {(button.hasText && button.name)? <StyledSpan >{button.name}</StyledSpan> : ``}\n              {button.feather? creatIcon(button.feather as iconKey || \"Copy\", button.iconSize) : \"\"}\n          </StyledButton>\n         )) : ``}\n        {menudict? Object.keys(menudict).length === 0 ? `` : <StyledDiv key=\"menu_bar\" className=\"custom_menu\" style={menudict.menuProps || {}}>\n          {!menudict.groups? `` : menudict.groups.map((group: buttonGroup, index) => (\n            <StyledDiv key={\"group_\" + group.name + index} className={\"menu_group \" + group.name} style={group.style || {}}>\n              {group.buttons.map((button: customButton, index)=>(\n                <StyledButton \n                  primary={button.primary || false}\n                  key={button.name? group.name + \"_\" + button.name + index : group.name + \"_button\" + index} \n                  className={(button.class? button.class: \"\" ) + (button.alwaysOn? \" always-on\" : \"\")+ (button.showWithIcon? \" with-icon\" : \"\")}\n                  theme={button.theme || {}} \n                  style={button.style || {}}\n                  onClick={(button.commands || button.response)? () => this.executeAll(button.commands || [], button.response) : () => {}}>\n                    {(button.hasText && button.name)? <StyledSpan>{button.name}</StyledSpan> : ``}\n                    {button.feather? creatIcon(button.feather as iconKey || \"Copy\", button.iconSize) : \"\"}\n              </StyledButton>\n              ))}\n            </StyledDiv>\n          ))}\n        </StyledDiv> : ``\n        }\n        {infoBarDict? Object.keys(infoBarDict).length === 0 ? `` : <StyledDiv key=\"info_bar\" className={\"custom_info_bar \" + (infoBarDict.name? infoBarDict.name : \"\")} style={infoBarDict.style}>\n          {(infoBarDict.info || []).map((info: customInfoText, index)=>(\n            <StyledRegSpan key={\"info_\" + (info.name? info.name : \"\") + index} className={info.class || ``} style={info.style || {}}>\n              {info.name}\n            </StyledRegSpan>\n          ))}\n        </StyledDiv> : `` }\n      </StyledCodeEditor>\n    )\n  }\n  //END OF RENDER FUNCTION\n  //----------------------------------------------------------------------\n}\n\nexport default withStreamlitConnection(CodeEditor)"],"mappings":"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"},"metadata":{},"sourceType":"module"}